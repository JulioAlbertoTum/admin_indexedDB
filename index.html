<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tutorial de indexedDB</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script type="text/javascript">
        var indexedDB = window.indexedDB || window.mozIndexedDB || window.webkitIndexedDB || window.msIndexedDB;
        
        function startDB(){
            dataBase = indexedDB.open("basesita",1);

            dataBase.onupgradeneeded = function(e){
                active = dataBase.result;
                object = active.createObjectStore('people',{keyPath: 'id', autoIncrement: true});
                object.createIndex('by_name','name', {unique: false});
                object.createIndex('by_dni', 'dni', {unique: true});
            };

            dataBase.onsuccess = function(e){
                alert('Base de datos cargada correctamente');
            };

            dataBase.onerror = function(e){
                alert("Error cargando la base de datos");
            }    
        }

        function add(){
            var active = dataBase.result;
        var data = active.transaction(["people"], "readwrite");
            var object = data.objectStore("people");

            var request = object.put({
                dni: document.querySelector("#dni").value,
                name: document.querySelector("#name").value,
                surname: document.querySelector("#surname").value
            });

            request.onerror = function(e){
                alert(request.error.name+"\n\n"+request.error.message);
            };

            data.oncomplete = function(e){
                document.querySelector("#dni").value = '';
                document.querySelector("#name").value = '';
                document.querySelector("#surname").value = '';
                alert("objeto agregado correctamente");
            }
        }
    </script>
</head>
<body onload="startDB();">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <!--<div class="input-group">-->
                    <input type="text" class="form-control" id ="dni" placeholder="Introducir dni"/>
                <!--</div>s-->
                <input type="text" class="form-control" id ="name" placeholder="Introducir nombre"/>
                <input type="text" class="form-control" id ="surname" placeholder="Introducir Apellidos"/>
                <button type="button" class="btn btn-primary" onclick="add();">Guardar</button>
            </div>
        </div>
    </div>
</body>
</html>
